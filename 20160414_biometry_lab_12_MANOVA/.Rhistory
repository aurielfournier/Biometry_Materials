library(auriel)
library(ggplot2)
fl <- list.files("./data/2015_raw_duck_data/", pattern=".csv")
files <- list()
fl
fl <- list.files("./data/2015_raw_duck_data/", pattern=".csv")
fl
getwd()
setwd("~/")
fl <- list.files("./data/2015_raw_duck_data/", pattern=".csv")
fl
files <- list()
names <- c("day","month","year","impound","treat","total_duck","mall",'gadw',"nopi","agwt","nosh","amwi","rndu","cago","coot","other","ice_cover")
for(i in 1:length(fl)){
fll  <- read.csv(paste0("./data/2015_raw_duck_data/",fl[i]))
colnames(fll) <- names
files[[i]] <- fll
}
master_DUCK <- do.call(rbind, files)
hec <- read.csv("./data/hectares.csv")
master_hec <- merge(master_DUCK, hec, by="impound")
master_hec$waterfowl_hectare <- master_hec$total_duck/master_hec$hectares
late <- c("scmsu2","scmsu3","m11","ts6a","ash","ts2a","ts4a","ccmsu2","kt9","kt6","dc22","dc20","os23","pooli")
early <- c("rail","sanctuary","sgd","sgb","pool2","pool2w","m13","m10","ts8a","ccmsu12","kt5","kt2","dc14","dc18","os21","poole","poolc")
master_hec$no_control <- NA
master_hec[master_hec$impound %in% late,]$no_control <- "late"
master_hec[master_hec$impound %in% early,]$no_control <- "early"
master_hec
unique(master_hec$impound)
write.csv(master_hec, row.names=FALSE, file="./data/2015_waterfowl.csv")
ggplot()+
geom_boxplot(data=master_hec[master_hec$ice_cover==0,], aes(x=no_control, y=waterfowl_hectare))+
theme_krementz()
model <- lm(data=master_hec[master_hec$ice_cover==0,], waterfowl_hectare ~ no_control)
summary(model)
master_hec$coot_hectare <- master_hec$coot/master_hec$hectares
model_coot <- lm(data=master_hec[master_hec$ice_cover==0,], coot_hectare ~ no_control)
summary(model_coot)
setwd("~/Biometry_Materials/20160414_biometry_lab_12_MANOVA")
library(ggplot2) # graphing
library(ggthemes) # theme_few
library(ggfortify) # autoplot
# responses <- cbind(object$response1, object$response2)
# manova(responses ~ object$covariate)
# Use the data in "fish_density.csv"
dat <- read.csv("fish_density.csv")
head(dat)
str(dat)
summary(dat)
responses <- cbind(dat$VOLUME, dat$VELOCITY)
op <- options(contrasts=c("contr.helmert","contr.poly"))
model <- manova(responses ~ STREAM + SEASON,data=dat)
linearHypothesis(model, diag(6), c(0,1))
library(multcomp)
install.packages("multcomp")
?linearHypothesis
library(car)
?linearHypothesis
linearHypothesis(model, c("(Intercept) = 0 ","SEASON = 1"))
model
summary(model)
linearHypothesis(model, c("STREAM = 1","SEASON = 1"))
linearHypothesis(model, c("STREAM","SEASON"), c(0,1))
linearHypothesis(model, "STREAM = SEASON")
# Biometry 2016
# Lab 12
# MANOVA
library(ggplot2) # graphing
library(ggthemes) # theme_few
library(ggfortify) # autoplot
# responses <- cbind(object$response1, object$response2)
# manova(responses ~ object$covariate)
# Use the data in "fish_density.csv"
dat <- read.csv("fish_density.csv")
head(dat)
str(dat)
summary(dat)
# The file contains some data from a recent study.
# We are interested in whether habitat differs among seasons and streams in Ozark streams.
# We collected habitat data three streams each in Boston Mountains and Ozark Highlands ecoregions.
# I come to you as my statistician with my data file for 2002 and ask you whether there are differences in stream habitat volume (VOLUME) and current velocity (VELOCITY) among seasons (SEASON or SEASNUM) and streams (STREAM or STREAMNUM) in the Boston Mountain ecoregion (select STREAMNUM<=3).
# What are the assumptions for this type of test and how can you check for them?
# Normality
ggplot()+geom_boxplot(data=dat, aes(x=SEASON, y=VOLUME))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=SEASON, y=VELOCITY))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=STREAM, y=VOLUME))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=STREAM, y=VELOCITY))+theme_few()
ggplot()+geom_histogram(data=dat, aes(x=VELOCITY))+facet_wrap(~STREAM)+theme_few()
ggplot()+geom_histogram(data=dat, aes(x=VOLUME))+facet_wrap(~STREAM)+theme_few()
ggplot()+geom_histogram(data=dat, aes(x=VELOCITY))+facet_wrap(~SEASON)+theme_few()
ggplot()+geom_histogram(data=dat, aes(x=VOLUME))+facet_wrap(~SEASON)+theme_few()
# Homogeneity of Variance & Covariance
ggplot()+geom_boxplot(data=dat, aes(x=SEASON, y=VOLUME))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=SEASON, y=VELOCITY))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=STREAM, y=VOLUME))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=STREAM, y=VELOCITY))+theme_few()
cov(dat[,c("VELOCITY","VOLUME")])
# Outliers
# outliers are a big deal in MANOVAs, check and see if you have any, transform to get rid of them.
ggplot()+geom_boxplot(data=dat, aes(x=SEASON, y=VOLUME))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=SEASON, y=VELOCITY))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=STREAM, y=VOLUME))+theme_few()
ggplot()+geom_boxplot(data=dat, aes(x=STREAM, y=VELOCITY))+theme_few()
# Independence
# think about the experimental design, look for grouping or avoidance in the data
# Run the MANOVAs and interpret the output.
# first we bind together the columns (cbind) of our two responses into a new object
responses <- cbind(dat$VOLUME, dat$VELOCITY)
#op <- options(contrasts=c("contr.helmert","contr.poly"))
model <- manova(responses ~ STREAM + SEASON,data=dat)
summary(model)
linearHypothesis(model, "STREAM = SEASON")
library(car)
library(multcomp)
linearHypothesis(model, "STREAM = SEASON")
?linearHypothesis
print(model)
print(model)
linearHypothesis(model, hypothesis.matrix=contrasts(dat$STREAM))
con_stream <- contrasts(dat$STREAM)
con_stream
linearHypothesis(model, hypothesis.matrix=con_stream))
linearHypothesis(model, hypothesis.matrix=con_stream)
str(con_stream)
con_stream <- data.frame(contrasts(dat$STREAM))
con_stream
str(con_stream)
linearHypothesis(model, hypothesis.matrix=con_stream)
con_stream <- matrix(data.frame(contrasts(dat$STREAM)))
con_stream
con_stream <- contrasts(dat$STREAM)
con_stream
morel <- read.table(file = "http://www.public.iastate.edu/~maitra/stat501/datasets/morel.dat",  col.names=c("studentgroup", "aptitude", "mathematics", "language", "generalknowledge"))
head(more1)
head(morel)
unique(morel$studentgroup)
contrasts(morel$studentgroup)
contrasts(as.factor(morel$studentgroup))
fit.lm1 <- lm(cbind(aptitude, mathematics, language, generalknowledge)~studentgroup , data = morel, contrasts = list(studentgroup = contr.SAS))
fit.lm1 <- lm(cbind(aptitude, mathematics, language, generalknowledge)~factor(studentgroup) , data = morel, contrasts = list(studentgroup = contr.SAS))
fit.lm1 <- lm(cbind(aptitude, mathematics, language, generalknowledge)~factor(studentgroup) , data = morel, contrasts = list(factor(studentgroup) = contr.SAS))
morel$studentgroup <- factor(morel$studentgroup)
fit.lm1 <- lm(cbind(aptitude, mathematics, language, generalknowledge)~studentgroup , data = morel, contrasts = list(studentgroup = contr.SAS))
fit.manova <- Manova(fit.lm)\
fit.manova <- Manova(fit.lm)
fit.lm <- lm(cbind(aptitude, mathematics, language, generalknowledge)~studentgroup , data = morel)
fit.manova <- Manova(fit.lm)
contrasts(morel$studentgroup)
t(contrasts(morel$studentgroup))
model <- manova(responses ~ STREAM + SEASON,data=dat)
con_stream <- t(contrasts(dat$STREAM))
linearHypothesis(model, hypothesis.matrix=con_stream)
dim(t(contrasts(morel$studentgroup)))
install.packages("Hotelling")
library(Hotelling)
hotelling.test(responses dat$STREAM + dat$SEASON)
hotelling.test(responses, dat$STREAM + dat$SEASON)
hotelling.test(responses ~SEASON, data=dat)
htest <- hotelling.test(responses ~SEASON, data=dat)
htest
htest <- hotelling.test(responses ~STREAM, data=dat)
htest_season <- hotelling.test(responses ~SEASON, data=dat)
htest_stream <- hotelling.test(responses ~STREAM, data=dat)
htest_season
htest_season
htest_stream
htest_season <- hotelling.test(responses ~SEASON, data=dat)
htest_stream <- hotelling.test(responses ~STREAM, data=dat)
summary(model)
anova1 <- aov(data=dat, VELOCITY ~ STREAM + SEASON)
anova2 <- aov(data=dat, VOLUME ~ STREAM + SEASON)
TukeyHSD(anova1, which="STREAM")
TukeyHSD(anova1, which="SEASON")
TukeyHSD(anova2, which="STREAM")
TukeyHSD(anova2, which="SEASON")
htest_season <- hotelling.test(responses ~SEASON+STREAM, data=dat)
?hotelling.test
mahalanobis(dat[,c("VELOCITY","VOLUME")])
ma <- cbind(1:6, 1:3)
ma
S <- var(ma)
S
mahalanobis(c(0,0), 1:2, S)
mahalanobis(dat[,c("VELOCITY","VOLUME")], 0, diag(ncol(x))) == rowSums(x*x)
mahalanobis(dat[,c("VELOCITY","VOLUME")], 0, diag(ncol(x))) == rowSums(x*x))
mahalanobis(dat[,c("VELOCITY","VOLUME")], 0, diag(ncol(x))) == rowSums(x*x)
mahalanobis(dat[,c("VELOCITY","VOLUME")], 0, diag(ncol(dat))) == rowSums(dat*dat)
mahalanobis(dat[,c("VELOCITY","VOLUME")], 0, diag(ncol(dat))) == rowSums(x*x)
mahalanobis(dat[,c("VELOCITY","VOLUME")], 0, diag(ncol(dat)))
diag(ncol(dat))
mahalanobis(dat[,c("VELOCITY","VOLUME")], 0, diag(2))
nrow(dat)
means <- colMeans(dat[,c("VELOCITY","VOLUME")])
mahalanobis(dat[,c("VELOCITY","VOLUME")], means, diag(2))
?hotelling.stat
?mahalanobis
?chisq.test
qchisq(p=0.05, df=149)
qchisq(p=0.05, df=140)
unique(dat$SEASON)
unique(dat$STREAM)
streams <- unique(dat$streams)
seasons <- unique(dat$seasons)
streams <- unique(dat$STREAM)
seasons <- unique(dat$SEASON)
for(i in streams){
for(j in seasons){
cov(dat[dat$SEASON==streams[i]&dat$STREAM==seasons[j],c("VOLUME","VELOCITY")])
}
}
streams <- unique(dat$STREAM)
seasons <- unique(dat$SEASON)
streams
seasons
streams[i]
i <- 1
streams[i]
for(i in streams){
for(j in seasons){
cov(dat[dat$SEASON==streams[i]&dat$STREAM==seasons[j],c("VOLUME","VELOCITY")])
}
}
for(i in streams){
for(j in seasons){
dat[dat$SEASON==streams[i]&dat$STREAM==seasons[j],c("VOLUME","VELOCITY")]
}
}
table(dat$SEASON, dat$STREAM)
dat <- dat[dat$STREAMNUM<=3,]
streams <- unique(dat$STREAM)
seasons <- unique(dat$SEASON)
streams
seasons
table(dat$SEASON, dat$STREAM)
streams <- unique(as.character(dat$STREAM))
seasons <- unique(as.character(dat$SEASON))
streams
seasons
for(i in streams){
for(j in seasons){
dat[dat$SEASON==streams[i]&dat$STREAM==seasons[j],c("VOLUME","VELOCITY")]
}
}
for(i in streams){
for(j in seasons){
cov(dat[dat$SEASON==streams[i]&dat$STREAM==seasons[j],c("VOLUME","VELOCITY")])
}
}
list_of_covs <- list()
for(i in streams){
for(j in seasons){
list_of_covs[[paste0(i,j)]]  cov(dat[dat$SEASON==streams[i]&dat$STREAM==seasons[j],c("VOLUME","VELOCITY")])
}
}
for(i in streams){
for(j in seasons){
list_of_covs[[paste0(i,j)]] <-  cov(dat[dat$SEASON==streams[i]&dat$STREAM==seasons[j],c("VOLUME","VELOCITY")])
}
}
list_of_covs
for(i in streams){
for(j in seasons){
list_of_covs[[paste0(i,j)]] <-  cov(dat[dat$SEASON==i&dat$STREAM==j,c("VOLUME","VELOCITY")])
}
}
list_of_covs
i <- 1
j <- i
j
i
cov(dat[dat$SEASON==i&dat$STREAM==j,c("VOLUME","VELOCITY")])
dat[dat$SEASON==i&dat$STREAM==j,c("VOLUME","VELOCITY")]
table(dat$SEASON, dat$STREAM)
seasons[1]
streams[1]
dat[dat$SEASON==i&dat$STREAM==j,c("VOLUME","VELOCITY")]
head(dat)
i <- "Bear"
j <- "April"
dat[dat$SEASON==i&dat$STREAM==j,c("VOLUME","VELOCITY")]
dat[dat$SEASON==i&dat$STREAM==j,]
i <- "April"
j <- "Bear"
dat[dat$SEASON==i&dat$STREAM==j,]
for(i in streams){
for(j in seasons){
list_of_covs[[paste0(i,j)]] <-  cov(dat[dat$SEASON==j&dat$STREAM==i,c("VOLUME","VELOCITY")])
}
}
list_of_covs
